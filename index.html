<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Lista de Tareas Vue</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/vue/2.7.16/vue.min.js"></script>
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/4.6.2/css/bootstrap.min.css"
      rel="stylesheet"
    />
  </head>
  <body>
    <div id="app">
      <p>Nombre: {{persona.nombre}}</p>
      <p>Edad: {{persona.edad}}</p>
      <p>Ciudad: {{persona.ciudad}}</p>
      <p>
        Hola, mi nombre es {{persona.nombre}}, tengo {{persona.edad}} y vivo en
        {{persona.ciudad}}
      </p>
      <hr />
      <!--  -------------------------------------------------------------------- -->
      <h4>Valor: {{valor}}</h4>
      <button class="" v-on:click="aumentar()">Incrementar</button>
      <button class="" v-on:click="disminuir()">Decrementar</button>
      <hr />
      <!-- --------------------------------------------------------------------- -->
      <h4>Lista de Tareas</h4>
      <input type="text" v-model="nuevaTarea" placeholder="Nueva Tarea" />
      <button v-on:click="agregarTarea()">Agregar Tarea</button>
      <ul>
        <li v-for="tarea in tareas" :key="tarea.id">
          <input
            type="checkbox"
            v-model="tarea.completada"
            @change="actualizarTarea(tarea)"
          />
          <span
            :style="{ textDecoration: tarea.completada ? 'line-through' : 'none' }"
            >{{ tarea.texto }}</span
          >
        </li>
      </ul>
      <p>Total de Tareas: {{ totalTareas }}</p>
      <p>Tareas Pendientes: {{ tareasPendientes }}</p>
      <hr />
      <!-- --------------------------------------------------------------------- -->
      <h4>Hooks de App2 (en vivo):</h4>
      <ul>
        <li v-for="evento in listaApp2" :key="evento.id">
          {{ evento.nombre }}: {{ evento.timestamp }}
        </li>
      </ul>
    </div>
    <!-- --------------------------------------------------------------------- -->
    <div id="app2">
      <h4>Soy App2 - Me destruyo en {{countdown}} segundos</h4>
    </div>

    <script>
      var app = new Vue({
        el: "#app",
        data: {
          persona: {
            nombre: "Ana GarcÃ­a",
            edad: 30,
            ciudad: "Tupungato",
          },
          valor: 0,
          nuevaTarea: "",
          tareas: [
            { id: 1, texto: "pagar luz", completada: false },
            { id: 2, texto: "llamar al seguro", completada: false },
            { id: 3, texto: "comprar carne", completada: false },
          ],
          listaApp2: [],
        },
        methods: {
          aumentar() {
            this.valor++;
          },
          disminuir() {
            this.valor--;
          },
          agregarTarea() {
            if (this.nuevaTarea.trim() !== "") {
              this.tareas.push({
                id: this.tareas.length + 1,
                texto: this.nuevaTarea,
                completada: false,
              });
              this.nuevaTarea = "";
            }
          },
          crearApp2() {
            var app2 = new Vue({
              el: "#app2",
              data: {
                countdown: 5,
                registrado: {
                  beforeUpdate: false,
                  updated: false,
                },
              },

              beforeCreate() {
                console.log("APP2 - beforeCreate:", Date.now());
              },

              created() {
                console.log("APP2 - created:", Date.now());
                app.listaApp2.push({
                  id: app.listaApp2.length + 1,
                  nombre: "APP2 - created",
                  timestamp: Date.now(),
                });
              },

              beforeMount() {
                console.log("APP2 - beforeMount:", Date.now());
                app.listaApp2.push({
                  id: app.listaApp2.length + 1,
                  nombre: "APP2 - beforeMount",
                  timestamp: Date.now(),
                });
              },

              mounted() {
                console.log("APP2 - mounted:", Date.now());
                app.listaApp2.push({
                  id: app.listaApp2.length + 1,
                  nombre: "APP2 - mounted",
                  timestamp: Date.now(),
                });

                const interval = setInterval(() => {
                  this.countdown--;
                  if (this.countdown === 0) {
                    clearInterval(interval);
                    this.$destroy();
                  }
                }, 1000);
              },

              beforeUpdate() {
                if (!this.registrado.beforeUpdate) {
                  console.log("APP2 - beforeUpdate:", Date.now());
                  app.listaApp2.push({
                    id: app.listaApp2.length + 1,
                    nombre: "APP2 - beforeUpdate",
                    timestamp: Date.now(),
                  });
                  this.registrado.beforeUpdate = true;
                }
              },

              updated() {
                if (!this.registrado.updated) {
                  console.log("APP2 - updated:", Date.now());
                  app.listaApp2.push({
                    id: app.listaApp2.length + 1,
                    nombre: "APP2 - updated",
                    timestamp: Date.now(),
                  });
                  this.registrado.updated = true;
                }
              },

              beforeDestroy() {
                console.log("APP2 - beforeDestroy:", Date.now());
                app.listaApp2.push({
                  id: app.listaApp2.length + 1,
                  nombre: "APP2 - beforeDestroy",
                  timestamp: Date.now(),
                });
              },

              destroyed() {
                console.log("APP2 - destroyed:", Date.now());
                app.listaApp2.push({
                  id: app.listaApp2.length + 1,
                  nombre: "APP2 - destroyed",
                  timestamp: Date.now(),
                });
              },
            });
          },
        },
        computed: {
          totalTareas() {
            return this.tareas.length;
          },
          tareasPendientes() {
            return this.tareas.filter((tarea) => !tarea.completada).length;
          },
        },
        mounted() {
          setTimeout(() => {
            this.crearApp2();
          }, 2000);
        },
      });
    </script>
  </body>
</html>
